<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>potential • potential</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="potential">
<meta property="og:description" content="potential">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">potential</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/potential.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/web_only/exemple.html">Stewart Potentials: a Use Case</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/riatelab/potential/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>potential</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/riatelab/potential/blob/HEAD/vignettes/potential.Rmd" class="external-link"><code>vignettes/potential.Rmd</code></a></small>
      <div class="hidden name"><code>potential.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="historic-and-conceptual-background">Historic and conceptual background<a class="anchor" aria-label="anchor" href="#historic-and-conceptual-background"></a>
</h2>
<div class="section level3">
<h3 id="modeling-spatial-interactions">Modeling spatial interactions<a class="anchor" aria-label="anchor" href="#modeling-spatial-interactions"></a>
</h3>
<p>Modeling spatial interactions is used to understand and quantify the level of interaction between different locations.<br>
The most ancient and common spatial interactions model the gravity model. It has roots in the late 19st century and has been used in several fields (geography, economy, demography) to model a high variety of flows (commuting, trade, migrations). A brief presentation can be found in <span class="citation">Rodrigue, Comtois, and Slack (2013)</span> and a more detailed one, among many others, in <span class="citation">Fotheringham and O’Kelly (1989)</span>.</p>
</div>
<div class="section level3">
<h3 id="a-place-based-model-stewarts-potentials">A place-based model: Stewart’s potentials<a class="anchor" aria-label="anchor" href="#a-place-based-model-stewarts-potentials"></a>
</h3>
<p>There are two main ways of modeling spatial interactions: the first one focuses on links between places (flows), the second one focuses on places and their influence at a distance. Following the physics metaphor, the flow may be seen as the <strong>gravitational force</strong> between two masses, the place influence as the <strong>gravitational potential</strong>. The <code>potential</code> package, as its name suggests, proposes an implementation of the place-based model of potential defined by John Q. Stewart <span class="citation">(1941)</span>.</p>
<p>The Stewart model is also known in the literature, depending on the discipline, as <strong>potential access</strong>, <strong>gravitational potential</strong> or <strong>gravitational accessibility</strong>. The concept was developed in the 1940s by physicist John Q. Stewart from an analogy to the gravity model. In his seminal work on the catchment areas of American universities, Stewart computes <strong>potentials of population</strong>. This potential is defined as a stock of population weighted by distance:</p>
<p><span class="math display">\[
A_i = \sum_{j=1}^n O_j f(d_{ij})
\]</span></p>
<p>The terms of this equation can be interpreted in a potential approach or an accessibility approach (in brackets):</p>
<ul>
<li>
<span class="math inline">\(A_i\)</span> is the potential at <span class="math inline">\(i\)</span> (the accessibility)</li>
<li>
<span class="math inline">\(O_j\)</span> is the stock of population at <span class="math inline">\(j\)</span> (the number of opportunities)</li>
<li>
<span class="math inline">\(f(d_{ij})\)</span> is a negative function of the distance between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, mainly of the power or the exponential form.</li>
</ul>
<p>The computation of potentials could be considered as a <strong>spatial interpolation method</strong> such as inverse distance weighted interpolation (IDW) or kernel density estimator (KDE). These models aim to estimate unknown values of non-observed points from known values given by measure points. Cartographically speaking, they are often used to get a continuous surface from a set of discrete points. However, we argue that the Stewart model is mainly a spatial interaction modeling approach, with a possible secondary use for spatial interpolation.</p>
</div>
<div class="section level3">
<h3 id="the-distance-friction">The distance friction<a class="anchor" aria-label="anchor" href="#the-distance-friction"></a>
</h3>
<p>Modeling spatial interactions implies quantifying the distance friction or impedance. The role of the distance can be interpreted as a disincentive to access desired destinations or opportunities (e.g. jobs, shops). At the very place of the opportunity, the interaction function equals 1, meaning that the potential access is 100%. Far away from the opportunity, the interaction function tends to 0, meaning that the potential access is 0 %. The <strong>span</strong> is defined as the value where the interaction function falls to 0.5 (50%). From the individuals’ point of view, this function may be seen as a degree of availability of a given opportunity. From the opportunity’s point of view (a store for example), the interaction function may be seen as a decreasing catchment area: there is a maximal attraction close to the opportunity and this attraction decreases progressively through distance.</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="potential-in-one-point">Potential in one point<a class="anchor" aria-label="anchor" href="#potential-in-one-point"></a>
</h3>
<p>The first example details the steps involved in the computation of the potential for one point (<span class="math inline">\(A_{i=1}\)</span>). This example is based on a population dataset of administrative units of the French region of Occitanie. The stocks of population (<span class="math inline">\(O_j\)</span>) are located on the centroids of the regions.</p>
<div class="figure">
<img src="potential_files/figure-html/setup-1.png" alt="$O_j$ and $_i$" width="576"><p class="caption">
<span class="math inline">\(O_j\)</span> and <span class="math inline">\(_i\)</span>
</p>
</div>
<p>The first step is computing the distances between the point and all population places.</p>
<div class="figure">
<img src="potential_files/figure-html/setup2-1.png" alt="$d_{ij}$" width="576"><p class="caption">
<span class="math inline">\(d_{ij}\)</span>
</p>
</div>
<p>For the next step we have to select a distance friction function. <code><a href="../reference/plot_inter.html">plot_inter()</a></code> allows to visualize the decrease of the interaction intensity with the distance according to the selected function and its parameters.</p>
<div class="figure">
<img src="potential_files/figure-html/curve-1.png" alt="$f(d_{ij})$" width="576"><p class="caption">
<span class="math inline">\(f(d_{ij})\)</span>
</p>
</div>
<p>Here, the probability of interaction at the span value (75 km) is 0.5.</p>
<p>We can now use the values of the interaction intensity for each distance between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>.</p>
<div class="figure">
<img src="potential_files/figure-html/setup3-1.png" alt="$f(d_{ij})$" width="576"><p class="caption">
<span class="math inline">\(f(d_{ij})\)</span>
</p>
</div>
<p>The contribution of each <span class="math inline">\(j\)</span> to the total potential (<span class="math inline">\(A_i\)</span>) is equal to the interaction intensity multiplied by its mass (<span class="math inline">\(O_j f(d_{ij}\)</span>).</p>
<div class="figure">
<img src="potential_files/figure-html/unnamed-chunk-2-1.png" alt="$O_j f(d_{ij})$" width="576"><p class="caption">
<span class="math inline">\(O_j f(d_{ij})\)</span>
</p>
</div>
<p>It can be rendered cartographically in the following figure.</p>
<div class="figure">
<img src="potential_files/figure-html/unnamed-chunk-3-1.png" alt="$O_j f(d_{ij})$" width="576"><p class="caption">
<span class="math inline">\(O_j f(d_{ij})\)</span>
</p>
</div>
<p>Finally, the value of the potential of <span class="math inline">\(i\)</span> is the sum of each <span class="math inline">\(j\)</span>’s contributions.</p>
</div>
<div class="section level3">
<h3 id="potentials-in-a-pseudo-continuous-space">Potentials in a pseudo-continuous space<a class="anchor" aria-label="anchor" href="#potentials-in-a-pseudo-continuous-space"></a>
</h3>
<p>A common practice is to compute potentials on points of a regular grid to estimate potentials on a pseudo-continue surface.</p>
<p>We can use the same dataset as an example of use.</p>
<div class="section level4">
<h4 id="create-a-regular-grid">Create a regular grid<a class="anchor" aria-label="anchor" href="#create-a-regular-grid"></a>
</h4>
<p><code><a href="../reference/create_grid.html">create_grid()</a></code> is used to create a regular grid with the extent of an existing layer (<code>x</code>) and a specific resolution (<code>res</code>). The resolution is set in units of <code>x</code> (here, meters).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/riatelab/potential" class="external-link">potential</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/riatelab/mapsf/" class="external-link">mapsf</a></span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span><span class="va">n3_poly</span>, col<span class="op">=</span> <span class="st">"grey80"</span>, border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n3_poly</span>, res <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span><span class="va">y</span>, pch <span class="op">=</span> <span class="fl">23</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, bg <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">.5</span> <span class="op">)</span></code></pre></div>
<p><img src="potential_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="create-a-distance-matrix">Create a distance matrix<a class="anchor" aria-label="anchor" href="#create-a-distance-matrix"></a>
</h4>
<p><code><a href="../reference/create_matrix.html">create_matrix()</a></code> is used to compute distances between objects.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_matrix.html">create_matrix</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n3_pt</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt;         1       2       3       4       5</span>
<span class="co">#&gt; 1 2674796 2578559 2482621 2387015 2291785</span>
<span class="co">#&gt; 2 2622868 2526551 2430532 2334847 2239539</span>
<span class="co">#&gt; 3 2682813 2587272 2492081 2397282 2302922</span>
<span class="co">#&gt; 4 2643075 2547108 2451462 2356179 2261302</span>
<span class="co">#&gt; 5 2638427 2542933 2447799 2353068 2258792</span></code></pre></div>
<p>The distance is expressed in map units (meters).</p>
</div>
<div class="section level4">
<h4 id="compute-the-potentials">Compute the potentials<a class="anchor" aria-label="anchor" href="#compute-the-potentials"></a>
</h4>
<p>The <code><a href="../reference/potential.html">potential()</a></code> function computes potentials.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span><span class="op">$</span><span class="va">pot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/potential.html">potential</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n3_pt</span>, y <span class="op">=</span> <span class="va">y</span>, d <span class="op">=</span> <span class="va">d</span>,
                   var <span class="op">=</span> <span class="st">"POP19"</span>, fun <span class="op">=</span> <span class="st">"e"</span>,
                   span <span class="op">=</span> <span class="fl">75000</span>, beta <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span><span class="va">n3_poly</span>, col<span class="op">=</span> <span class="st">"grey80"</span>, border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span><span class="va">y</span>, var <span class="op">=</span> <span class="st">"pot"</span>, type <span class="op">=</span> <span class="st">"prop"</span>, 
       inches<span class="op">=</span> <span class="fl">.1</span>, 
       lwd <span class="op">=</span> <span class="fl">.5</span>, 
       leg_val_cex <span class="op">=</span> <span class="fl">.5</span>, 
       leg_val_rnd <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>,
       leg_frame <span class="op">=</span> <span class="cn">TRUE</span>, 
       leg_pos <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span></code></pre></div>
<p><img src="potential_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>It’s possible to express the potential relatively to its maximum in order to display more understandable values <span class="citation">(Rich 1980)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span><span class="op">$</span><span class="va">pot2</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">y</span><span class="op">$</span><span class="va">pot</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">pot</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span><span class="va">n3_poly</span>, col<span class="op">=</span> <span class="st">"grey80"</span>, border <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span><span class="va">y</span>, var <span class="op">=</span> <span class="st">"pot2"</span>, type <span class="op">=</span> <span class="st">"prop"</span>, 
       inches<span class="op">=</span> <span class="fl">.1</span>, 
       lwd <span class="op">=</span> <span class="fl">.5</span>, 
       leg_val_cex <span class="op">=</span> <span class="fl">.5</span>, 
       leg_val_rnd <span class="op">=</span> <span class="fl">0</span>,
       leg_frame <span class="op">=</span> <span class="cn">TRUE</span>, 
       leg_pos <span class="op">=</span> <span class="st">"topright"</span><span class="op">)</span></code></pre></div>
<p><img src="potential_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>It’s also possible to compute areas of equipotential with <code><a href="../reference/equipotential.html">equipotential()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equipotential.html">equipotential</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, var <span class="op">=</span> <span class="st">"pot2"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, mask <span class="op">=</span> <span class="va">n3_poly</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iso</span>, var <span class="op">=</span> <span class="st">"center"</span>, type <span class="op">=</span> <span class="st">"choro"</span>, 
       breaks <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, 
       pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'teal'</span><span class="op">)</span>,
       lwd <span class="op">=</span> <span class="fl">.2</span>,
       border <span class="op">=</span> <span class="st">"#121725"</span>, 
       leg_pos <span class="op">=</span> <span class="st">"topright"</span>,
       leg_val_rnd <span class="op">=</span> <span class="fl">0</span>,
       leg_title <span class="op">=</span> <span class="st">"Potential of\nPopulation"</span><span class="op">)</span></code></pre></div>
<p><img src="potential_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="compute-the-potentials-using-parallel-computation">Compute the potentials using parallel computation<a class="anchor" aria-label="anchor" href="#compute-the-potentials-using-parallel-computation"></a>
</h4>
<p>In order to obtain smoother equipotential areas we need to compute the potentials on a much finer grid and that can be really time consuming with <code><a href="../reference/potential.html">potential()</a></code>.<br><code><a href="../reference/mcpotential.html">mcpotential()</a></code> computes potentials with a cutoff distance and parallel computation. The cutoff distance means that points that are too far away are not taken into account in the computation. The limits of this function are the impossibility to provide custom distance matrices (<code>d</code>), and the fact that it only uses Cartesian distances (hence its use for global data is likely to be inappropriate).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n3_poly</span>, res <span class="op">=</span> <span class="fl">20000</span><span class="op">)</span>
<span class="va">y</span><span class="op">$</span><span class="va">pot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcpotential.html">mcpotential</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n3_pt</span>, y <span class="op">=</span> <span class="va">y</span>, 
                     var <span class="op">=</span> <span class="st">"POP19"</span>, fun <span class="op">=</span> <span class="st">"e"</span>,
                     span <span class="op">=</span> <span class="fl">75000</span>, beta <span class="op">=</span> <span class="fl">2</span>, 
                     limit <span class="op">=</span> <span class="fl">200000</span>, ncl <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">y</span><span class="op">$</span><span class="va">pot2</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">y</span><span class="op">$</span><span class="va">pot</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">pot</span><span class="op">)</span>
<span class="va">iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equipotential.html">equipotential</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, var <span class="op">=</span> <span class="st">"pot2"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, mask <span class="op">=</span> <span class="va">n3_poly</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_map.html" class="external-link">mf_map</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iso</span>, var <span class="op">=</span> <span class="st">"center"</span>, type <span class="op">=</span> <span class="st">"choro"</span>, 
       breaks <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, 
       pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'teal'</span><span class="op">)</span>,
       lwd <span class="op">=</span> <span class="fl">.2</span>,
       border <span class="op">=</span> <span class="st">"#121725"</span>, 
       leg_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6194790</span>,<span class="fl">3428230</span><span class="op">)</span>,
       leg_val_rnd <span class="op">=</span> <span class="fl">0</span>,
       leg_title <span class="op">=</span> <span class="st">"Potential Intensity"</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_credits.html" class="external-link">mf_credits</a></span><span class="op">(</span>txt <span class="op">=</span> <span class="st">"© EuroGeographics for the administrative boundaries and © Eurostat for data"</span>,
           pos <span class="op">=</span> <span class="st">"bottomright"</span>, cex <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span>
<span class="fu"><a href="https://riatelab.github.io/mapsf/reference/mf_title.html" class="external-link">mf_title</a></span><span class="op">(</span>txt <span class="op">=</span> <span class="st">"Potential of population"</span>, bg <span class="op">=</span> <span class="st">"white"</span>, fg <span class="op">=</span> <span class="st">"black"</span>, inner <span class="op">=</span> <span class="cn">TRUE</span>, cex <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></code></pre></div>
<p><img src="smooth-1.png"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fotheringham1989spatial" class="csl-entry">
Fotheringham, A Stewart, and Morton E O’Kelly. 1989. <em>Spatial Interaction Models: Formulations and Applications</em>. Vol. 1. Kluwer Academic Publishers Dordrecht.
</div>
<div id="ref-rich1980potential" class="csl-entry">
Rich, David C. 1980. <span>“Potential Models in Human Geography.”</span> <em>CATMOG 26</em> 38.
</div>
<div id="ref-rodrigue2013spatial" class="csl-entry">
Rodrigue, Jean-Paul, Claude Comtois, and Brian Slack. 2013. <span>“Spatial Interactions and the Gravity Model.”</span> <em>The Geography of Transport Systems.</em> <a href="https://transportgeography.org/contents/methods/spatial-interactions-gravity-model/" class="external-link">https://transportgeography.org/contents/methods/spatial-interactions-gravity-model/</a>.
</div>
<div id="ref-STEWART41" class="csl-entry">
Stewart, John Q. 1941. <span>“An Inverse Distance Variation for Certain Social Influences.”</span> <em>Science</em> 93 (2404): 89–90. <a href="https://doi.org/10.1126/science.93.2404.89" class="external-link">https://doi.org/10.1126/science.93.2404.89</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Timothée Giraud, Hadrien Commenges.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
